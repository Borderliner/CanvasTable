<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
      html,
      body {
        padding: 0;
        margin: 0;
        width: 100%;
        height: 100%;
      }
    </style>
    <link rel="dns-prefetch" href="//fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="https://fonts.googleapis.com/css2?family=Lexend+Giga:wght@600&display=swap" rel="stylesheet" />
    <meta charset="UTF-8" />
    <title>Canvas Table CPU Usage Test</title>
  </head>
  <body></body>
  <script src="./umd/canvastable.min.js"></script>
  <script>
    function tableCreate() {
      const wrapper = document.createElement('div')
      document.body.appendChild(wrapper)
      const columns = colMock()

      const ct = new CanvasTable({
        container: wrapper,
        columns: columns,
        style: { height: 300, width: 800 },
        onRow: (record, index) => ({
          onClick: () => { alert(JSON.stringify(record)) }
        })
      })

      const refreshTime = Math.floor(Math.random() * 100) + 400 // slow
      // const refreshTime = 500 // fast
      ct.source = []
      setTimeout(() => {
        ct.source = dataMock(50)
      }, 3000)
    }
    function dataMock(len) {
      let data = []
      for (let j = 0; j < len; j++) {
        let row = {}
        Array.from({ length: 10 }).forEach((col, i) => {
          row[`col${i + 1}`] = Math.floor(Math.random() * 10000)
        })
        data.push(row)
      }
      return data
    }
    function colMock() {
      let columns = []
      for (let i = 0; i < 10; i++) {
        columns.push({
          dataIndex: `col${i + 1}`,
          title: `col${i + 1}`,
          popTitle: `col${i + 1}-pop`,
        })
      }
      return columns
    }

    tableCreate()
    tableCreate()
    tableCreate()
    tableCreate()
    tableCreate()
    tableCreate()
    tableCreate()
    tableCreate()
    tableCreate()
    tableCreate()
  </script>
</html>
